name: Generate Keystore

on:
    workflow_dispatch:

jobs:
    generate-keystore:
        runs-on: ubuntu-latest
        steps:
            - name: Set up JDK 17
              uses: actions/setup-java@v4
              with:
                  java-version: "17"
                  distribution: "temurin"

            - name: Generate Keystore
              run: |
                  keytool -genkey -v -keystore release-key.jks -keyalg RSA -keysize 2048 -validity 10000 -alias key0 -storepass "your_strong_password" -keypass "your_strong_password" -dname "CN=EM-AI, OU=Mobile, O=EMAI, L=Cairo, S=Cairo, C=EG"

                  echo "::notice title=Keystore Generated::Keystore file created successfully."

            - name: Convert to Base64 and Output
              run: |
                  BASE64_KEY=$(base64 -w 0 release-key.jks)

                  echo "=================================================================="
                  echo "                 COPY THESE VALUES TO GITHUB SECRETS              "
                  echo "=================================================================="
                  echo "NAME: ANDROID_KEYSTORE_BASE64"
                  echo "VALUE:"
                  echo "$BASE64_KEY"
                  echo ""
                  echo "NAME: KEYSTORE_PASSWORD"
                  echo "VALUE: your_strong_password"
                  echo ""
                  echo "NAME: KEY_ALIAS"
                  echo "VALUE: key0"
                  echo ""
                  echo "NAME: KEY_PASSWORD"
                  echo "VALUE: your_strong_password"
                  echo "=================================================================="

            - name: Upload Keystore (Optional Backup)
              uses: actions/upload-artifact@v4
              with:
                  name: release-keystore-backup
                  path: release-key.jks
                  retention-days: 1
